cat = {}
cat.paints = {name = "Paints",max=4,"paint","invertcolorpaint","invertpaint","invispaint","shadowpaint","hsvpaint","inverthsvpaint","blendmode"}
cat.tool_effects = {name = "Effects",max=4,"timerep_tool","grav_tool","armor_tool","bolt_tool","permaclamp_tool","prot_tool","petrify_tool","goo_tool","compel_tool","spikes_tool","tag_tool","ghost_tool","entangle_tool","input_tool","coin_tool"}

cat.walls = {name = "Walls",max=6,1,41,126,154,229,1088,150,151,152,965,709,710,1046,1117,162,566,564,565,706,707,916,917,351,552}
cat.pushables = {name = "Pushables",max=5,4,5,6,7,8,159,69,157,140,158,214,215,216,217,218,618,620,621,622,623,840,841,842,843,844,910,911,912,913,914}
cat.oppositions = {name = "Oppositions",max=6,696,697,698,699,936,937,52,53,54}
cat.weights = {name = "Weights",max=4,22,103,144,104,1182,1183,668,42,631,638,639,1184,142,143,1194,1185,1191,1195,1192,1196,669,1193,1187,1188,1189,1190,1197,1198,351,552}
cat.sticky = {name = "Sticky",max=5,252,647,648,788,789,649,650,651,790,791,207,231,249}
cat.extensions = {name = "Extensions",max=4,466,464,477}
cat.input = {name = "Input",max=5,910,911,912,913,914,915,916,917,918}
cat.decorative = {name = "Decorative",max=11,116,117,118,119,120,121,122,680,681,682,683,684,685,686,687,688,689,690,691,692,693,708,929,930,1186,931,932,1156,1171,933,934,1174,938,939,940,941}

cat.pushers = {name = "Pushers",max=4,2,28,72,74,59,60,76,78,269,271,273,275,277,279,281,283,213,284,346,304,311,303,400,206,781,700,718,720,863,423,865,864,904,905,1160,1161,352,552}
cat.pullers = {name = "Pullers",max=4,14,28,73,74,61,60,77,78,270,271,274,275,278,279,282,283,305,311,719,720,353,552}
cat.grabbers = {name = "Grabbers",max=4,71,72,73,74,75,76,77,78,272,273,274,275,280,281,282,283,400,354,552}
cat.drillers = {name = "Drillers",max=4,58,59,61,60,75,76,77,78,276,277,278,279,280,281,282,283,1162,355,552}
cat.slicers = {name = "Slicers",max=4,115,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,1086,1087,906,786,787,356,552}
cat.scissors = {name = "Scissors",max=4,178,179,182,183,180,181,184,185}
cat.missiles = {name = "Missiles",max=5,160,358,359,367,368,319,792,793,794,795,456,597,598,599,600,454,800,801,802,803}
cat.movers_other = {name = "Other",max=8,114,357,161,424,175,821,822,823,362,905,704,820,903,904,306,307,242,243,603,500,1167,1168,1169,1170,552}
cat.players = {name = "Players",max=7,239,829,289,290,291,297,292,288,830,293,294,295,298,296,614,845,846,321,552}
cat.particles = {name = "Particles",max=9,236,1133,1135,1145,1137,1139,1141,1143,1147,1149,1134,1136,1146,1138,1140,1142,1144,1148}

cat.generators = {name = "Generators",max=4,3,23,26,27,168,167,169,170,363,364,110,111,172,171,173,174,40,113,365,366,147,301,166,652,646,701}
cat.physicalgenerators = {name = "Physical Generators",max=10,342,749,750,751,752,673,769,770,771,772,395,753,754,755,756,674,773,774,775,776,393,757,758,759,760,675,777,778,779,780}
cat.supergenerators = {name = "Super Generators",max=4,55,457,458,459,606,607,608,609,460,461,610,611,612,613,1089,1115,448}
cat.replicators = {name = "Replicators",max=10,{45,46,397,398,399,177,513,514,515,516},{343,866,869,872,875,676,878,881,884,887},{396,867,870,873,876,677,879,882,885,888},{394,868,871,874,877,678,880,883,886,889},302,1090,341}
cat.builders = {name = "Builders",max=4,327,328,329,330,331,332,333,334,335,336,337,338,339,340,229,1088}
cat.makers = {name = "Makers",max=9,{526,527,528,529,530,531,532,533,534},{1050,1051,1052,1053,1054,1055,1056,1057,1058},{1059,1060,1061,1062,1063,1064,1065,1066,1067},{1068,1069,1070,1071,1072,1073,1074,1075,1076},235,427}
cat.gates = {name = "Gates",max=5,32,33,34,194,195,35,36,37,196,197}
cat.sentries = {name = "Sentries",max=5,318,589,590,591,592,320,796,797,798,799,453,593,594,595,596,455,804,805,806,807}
cat.generators_other = {name = "Other",max=4,412}

cat.rotators = {name = "Rotators",max=8,{9,10,11,960,66,67,68,961},{994,995,996,997,998,999,1001,1002},{1003,1004,1005,1006,245,246,247,962},{957,958,959,963,442,443,444,964},{150,151,152,965,585,586,587,966},{1126,1127,1128,1129,522,523,524,967},57,70,552}
cat.flippers = {name = "Flippers",max=5,{30,89,90,640,1048},{641,709,711,1130,535},{654,655,656,713,1049},{714,710,712,1131,715}}
cat.redirectors = {name = "Redirectors",max=5,17,62,63,64,65,741,1044,1045,1046,1047,1132,989,990,991,992,993}
cat.orientators = {name = "Orientators",max=4,569,570,571,572,573,574,575,576,577,578,579,580,581,582}
cat.rotators_other = {name = "Other",max=4,105,583,447,462}

cat.repulsors = {name = "Repulsors",max=5,{21,408,409,410,411},{763,764,765,766,767},{50,721,722,723,724},{222,1100,1101,1102,1103},{417,418,419,420,421},{435,725,726,727,728},{984,985,986,987,988},{1175,1176,1177,1178,1179}}
cat.impulsors = {name = "Impulsors",max=5,{29,413,414,415,416},{1012,1013,1014,1015,1016},{248,729,730,731,732},{1104,1105,1106,1107,1108},{1007,1008,1009,1010,1011},{984,985,986,987,988}}
cat.grapulsors = {name = "Grapulsors",max=4,81,82,227,228}
cat.mirrors = {name = "Mirrors",max=5,{15,56,80,315,316},{489,490,491,492,478},{629,630,657,313,314},{445,446,660,658,659},{661,662,663,664,479},480,481}
cat.crystals = {name = "Crystals",max=5,{403,404,405,406,407},{498,499,501,502,503},504}
cat.gems = {name = "Gems",max=5,{493,494,495,496,497},{919,920,921,922,923},{924,925,926,927,928},{942,943,944,945,946},{947,948,949,950,951},{952,953,954,955,956},{1095,1096,1097,1098,1099}}
cat.cyclers = {name = "Cyclers",max=5,{625,627,632,634,636},{626,628,633,635,637},642}
cat.gears = {name = "Gears",max=5,{18,469,473,108,482},{322,471,475,324,485},{19,470,474,109,483},{323,472,476,325,486},{968,969,970,971,972},{973,974,975,976,977},{449,450,484,451,452,487},{1021,1022,1023,1024,1025,1026},{1027,1028,1029,1030,1031,1032}}
cat.intakers = {name = "Intakers",max=5,{44,155,250,317,251},{517,518,519,520,521}}
cat.shifters = {name = "Shifters",max=4,106,107,254,255,256,257,259,258,260,261,262,263,265,264,679,847,653,665,666,667,1152,1153}
cat.forcers_other = {name = "Other",max=5,156}

cat.divergers = {name = "Divergers",max=8,16,31,429,430,38,39,208,209,93,94,83,433,84,85,91,92,431,432,95,96,86,434,87,88,300,210,233,601,488,224,702,703,980,982,981,983,1084,1085,351,552}
cat.forkers = {name = "Forkers",max=6,48,49,97,98,782,784,99,100,101,102,783,785}
cat.spooners = {name = "Spooners",max=4,186,187,188,189,190,191,192,193}
cat.slopes = {name = "Slopes",max=4,381,382,383,978,390,391,392,979,1017,1018,1019,1020,1091,1092,1093,1094}
cat.paraboles = {name = "Paraboles",max=4,384,385,388,389,386,387}
cat.divergers_other = {name = "Other",max=5,221,428,746,747,748,79}

cat.trashes = {name = "Trashes",max=4,12,225,226,205,347,349,694,695,438,439,440,441,348,350,733,734,463,856,890,891,892,893,894,895,436,437,176,300,563,908,909,351,552}
cat.demolishers = {name = "Demolishers",max=4,51,141,670,671,848,849,854,855,850,851,852,853,859,860,861,862,857,858,897,898,899,900,901,902}
cat.enemies = {name = "Enemies",max=4,13,24,163,164,360,361,244,299,827,828,838,839,1172,768,1165,1173,907,1166,915,1000,1167,1168,1169,1170,326,831,351,552}
cat.acids = {name = "Acids",max=4,220,219,717,716,863,423,865,864,351,552}
cat.fire = {name = "Fire",max=4,240,241,602,234,242,243,603}
cat.deleters = {name = "Deleters",max=5,1033,1034,1035,1036,1037,1038,1039,1040,1041,1042}
cat.sappers = {name = "Sappers",max=3,465,467,468}

cat.transformers = {name="Transformers",max=4,237,238,505,506,536,537,538,539,507,508,540,541,542,543,761}
cat.transmutators = {name="Transmutators",max=4,267,268,509,510,544,545,546,547,511,512,548,549,550,551,762}
cat.midases = {name="Midases",max=5,737,738,739,740,425,{742,743,744,426}}
cat.worms = {name="Worms",max=4,1077,1078,1079,1080,1081,1082}
cat.timewarpers = {name="Timewarpers",max=5,146,148,615,616,617,833,834,835,836,837}

cat.generation = {name="Generation",max=4,20,643,644,645}
cat.effects = {name="Effect Givers",max=5,25,286,287,1164,285,43,145,308,309,619,112,1199,136,137,138,139,253,935,310,522,523,524,967,535,715,525,232,588,266,424,252,647,648,788,789,649,650,651,790,791,824,825,826,736,896,745,105,583}
cat.infectious = {name="Infectious",max=6,47,126,176,149,161,211,123,127,128,124,129,130,125,131,132,134,135,133,808,809,810,811,812,813,371,373,369,377,379,375,1111,1113,1109,567,604,1125,1154}
cat.unlocking = {name="Unlocking",max=3,153,584,154,705,706,707,563,564,565}
cat.storage = {name="Storage",max=4,165,362,905,704,175,821,822,823,198,1043,831,645,1154,1150,1151,1083,918}
cat.ai = {name="AI",max=3,206,211,624}
cat.gizmos = {name = "Gizmos",max=5,344,345,672,814,818,815,817,816,1155,1116,1117,1159,1163,1157,1158}
cat.misc_other = {name = "Other",max=4,312,422,402,832,401,351,552}
cat.oneways = {name = "One-ways",max=5,553,554,555,556,557,558,559,560,561,562}
cat.zones = {name = "Zones",max=4,1118,1119,1120,1121,1122,1123,1124}
cat.collectable = {name="Collectable",max=3,223,224,230,1180,1181}

cat.placeables = {name="Placeables",max=3,"placeable","placeableW","placeableR","placeableO","placeableY","placeableG","placeableC","placeableB","placeableP"}
cat.rotatables = {name="Rotatables",max=4,{"rotatable","rotatable180"},{"hflippable","vflippable","duflippable","ddflippable"}}
cat.decorative_bg = {name="Decorative",max=4,"bggrass","bgdirt","bgstone","bgcobble","bgsand","bgsnow","bgice","bgmagma","bgwood","bgwool","bgplate","bgmossystone","bgcopper","bgsilver","bggold","bgspace","bgmatrix","bgvoid"}

cat.truecells = {name="True Cells",max=3,199,200,201,202,203,204}

lists = {}
lists[0] = {name = "Tools", cells = {max=99,"eraser",cat.paints,cat.tool_effects}, desc = "They aren't cells, but they do modify the world.", icon = "eraser"}
lists[1] = {name = "Basic", cells = {max=4,cat.walls,cat.pushables,cat.oppositions,cat.weights,cat.sticky,cat.extensions,cat.input,cat.decorative}, desc = "'Basic' cells.", icon = 4}
lists[2] = {name = "Movers", cells = {max=4,cat.pushers,cat.pullers,cat.grabbers,cat.drillers,cat.slicers,cat.scissors,cat.missiles,cat.movers_other,cat.players,cat.particles}, desc = "Can move on their own, usually with a certain type of force.", icon = 2}
lists[3] = {name = "Generators", cells = {max=4,cat.generators,cat.supergenerators,cat.physicalgenerators,cat.replicators,cat.builders,cat.makers,cat.gates,cat.generators_other}, desc = "Create or duplicate cells.", icon = 3}
lists[4] = {name = "Rotators", cells = {max=3,cat.rotators,cat.flippers,cat.redirectors,cat.orientators,cat.gears,cat.rotators_other}, desc = "Rotate other cells.", icon = 9}
lists[5] = {name = "Forcers", cells = {max=5,cat.repulsors,cat.impulsors,cat.grapulsors,cat.mirrors,cat.crystals,cat.gems,cat.cyclers,cat.gears,cat.intakers,cat.shifters,cat.forcers_other}, desc = "Still cells that generate a force.", icon = 21}
lists[6] = {name = "Divergers", cells  = {max=4,cat.divergers,cat.forkers,cat.spooners,cat.slopes,cat.paraboles,cat.divergers_other}, desc = "Causes whatever comes in to diverge to a different path.", icon = 16}
lists[7] = {name = "Destroyers", cells = {max=4,cat.trashes,cat.demolishers,cat.enemies,cat.missiles,cat.sentries,cat.acids,cat.fire,cat.deleters,cat.intakers,cat.sappers}, desc = "Destroy other cells.", icon = 12}
lists[8] = {name = "Transformers", cells = {max=4,cat.transformers,cat.transmutators,cat.midases,cat.worms,cat.timewarpers}, desc = "Transform cells into other cells.", icon = 237}
lists[9] = {name = "Miscellaneous", cells = {max=4,cat.generation,cat.infectious,cat.effects,cat.unlocking,cat.storage,cat.ai,cat.gizmos,cat.misc_other,cat.oneways,cat.zones,cat.collectable}, desc = "The ones that don't fit into another category.", icon = 20}
lists[10] = {name = "Backgrounds", cells = {max=3,cat.placeables,cat.rotatables,cat.decorative_bg}, desc = "Backgrounds that go behind cells. Usually used for Puzzle Mode.", icon = "placeableW"}
lists[11] = {name = "Cheats", cells = {max=99,cat.truecells,1200}, desc = "Cells that should not be used for making or breaking vaults.\nUse of these cells might cause bugs, so be careful.", icon = 199}

local function countCategory(category, unique, seen)
    local set = seen or {}
    local total = 0

    for i,v in ipairs(category) do
        if type(v) == "table" then
            for o,b in ipairs(v) do
                if not set[b] or not unique then
                    set[b] = true
                    total = total + 1
                end
            end
        elseif not set[v] or not unique then
            set[v] = true
            total = total + 1
        end
    end

    return total
end

local function countList(list, unique, seen)
    local set = seen or {}
    local total = 0

    for i,v in ipairs(list.cells) do
        if type(v) == "table" then
            total = total + countCategory(v, unique, set)
        elseif not set[v] or not unique then
            set[v] = true
            total = total + 1
        end
    end

    return total
end

local function listPaths(cell)
    local a = ""
    for i,v in ipairs(lists) do
        for o,b in ipairs(v.cells) do
            if b == cell then
                a = a..v.name..": Other, "
            elseif type(b) == "table" then
                for p,n in ipairs(b) do
                    if n == cell then
                        a = a..v.name..": "..b.name..", "
                    elseif type(n) == "table" then
                        for q,m in ipairs(n) do
                            if m == cell then
                                a = a..v.name..": "..b.name..", "
                            end
                        end
                    end
                end
            end
        end
    end
    return a:sub(1, -3)
end

require "cinfo"
--[[
local max = {}
local top = 0
for _,v in pairs(cellinfo) do
    max[#max+1] = v.name
end
table.sort(max, function(oa, ob)
    local a = oa:gsub(" ", "")
    local b = ob:gsub(" ", "")
    return (#a > #b) or (#a == #b and a < b)
end)
local at = 0
local out = "{| class=\"wikitable\"  "
for _,v in ipairs(max) do
    if at ~= #v:gsub(" ", "") then at = #v:gsub(" ", ""); out = out:sub(1, -3).."\n|-\n! "..#v:gsub(" ", "").."\n| " end
    out = out.."{{Cell|"..v.."}}, "
end
print(out.."\n|}")--]]
--[[
local aggs = {}
for _,v in pairs(cellinfo) do aggs[#v.name:gsub(" ", "")] = (aggs[#v.name:gsub(" ", "")] or 0) + 1 end
for i,v in pairs(aggs) do --print("! "..i.."\n| "..v.."\n|-") end--]]
--print(v) end
--print(countList(lists[10], true,  {}))
--print(countList(lists[10], false, {}))
print(listPaths(144))